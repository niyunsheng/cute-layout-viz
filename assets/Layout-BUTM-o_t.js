import{u as D,r as t,j as e}from"./index-CyG5ptUr.js";import{H as E,L as k,t as S,p as H,g as $}from"./LayoutGrid-3uQWtmFK.js";import"./pyodide-GADaI8Wc.js";function O(){const[l]=D(),[r,m]=t.useState(()=>l.get("layout")||"(12,(4,8)):(59,(13,1))"),[n,i]=t.useState(""),[L,p]=t.useState(null),[v,h]=t.useState(!1),[x,C]=t.useState(!0),[f,j]=t.useState("viridis"),[o,g]=t.useState({gridData:[],rows:0,cols:0,parsedLayout:null,colCoords:[],rowCoords:[]}),[y,d]=t.useState(0),[b,c]=t.useState(0);return t.useEffect(()=>{const a=l.get("layout");a&&(m(a),i(""))},[l]),t.useEffect(()=>{(async()=>{try{const s=await H(r);i("");const u=await $(s.shape,s.stride);if(g(u),u.gridData.length>0){const w=u.gridData.map(N=>N.offset);d(Math.min(...w)),c(Math.max(...w))}else d(0),c(0)}catch(s){i(s instanceof Error?s.message:"Unknown error"),g({gridData:[],rows:0,cols:0,parsedLayout:null,colCoords:[],rowCoords:[]}),d(0),c(0)}})()},[r]),e.jsxs("div",{className:"max-w-6xl p-0 leading-relaxed text-black",children:[e.jsx("h1",{className:"text-4xl m-0 text-black mb-6",children:"Layout"}),e.jsxs("div",{className:"max-w-full",children:[e.jsx("div",{className:"mb-4 max-w-4xl",children:e.jsxs("div",{className:"bg-white rounded-lg shadow p-3 mb-3",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-1",children:"Layout Input (Shape:Stride)"}),e.jsx("input",{type:"text",value:r,onChange:a=>m(a.target.value),className:"w-full px-3 py-2 border-2 border-gray-300 rounded focus:border-blue-500 focus:outline-none font-mono",placeholder:"e.g., (9,(4,8)):(59,(13,1))"}),n&&e.jsxs("div",{className:"mt-2 text-red-600 text-sm font-medium",children:["⚠️ ",n]}),!n&&o.parsedLayout&&e.jsx("button",{onClick:()=>{const s=`${`${window.location.origin}${window.location.pathname}`}#/layout?layout=${r}`;navigator.clipboard.writeText(s).then(()=>{h(!0),setTimeout(()=>h(!1),2e3)})},className:"mt-3 px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded font-medium transition-colors",children:v?"✓ Link copied!":"Share This Layout"})]})}),o.gridData.length>0&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 overflow-x-auto",children:[e.jsx(E,{heatmapEnabled:x,colorScheme:f,minOffset:y,maxOffset:b,onHeatmapToggle:C,onColorSchemeChange:j}),e.jsx(k,{grid:o,title:`Layout(${S(o.parsedLayout?.shape)}:${S(o.parsedLayout?.stride)})`,hoveredCell:L,onCellHover:(a,s)=>p({row:a,col:s}),onCellLeave:()=>p(null),heatmapEnabled:x,colorScheme:f,minOffset:y,maxOffset:b})]})]})]})}export{O as default};
